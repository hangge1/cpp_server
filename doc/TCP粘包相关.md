**应用层调用send和recv究竟发生了什么?**

内核区存在SendBuffer和RecvBuffer; 

send把待发送数据放到内核的SendBuffer中, recv从内核缓冲区RecvBuffer读数据!



**那么内核缓冲区的SendBuffer何时真正通过网卡发出呢?**

由网络协议栈决定, 因此发送的数据并不一定等于你应用层送到内核缓冲区的数据大小! 

可能仅仅只是你发送的数据包一部分,  或者是你的数据包一部分和别的包合并的数据!等等



**那么如何保证TCP通信的数据正确解析呢?**

TCP保证数据不会丢和有序! 所以应用层的任务就是确保拿到完整的数据包, 自然就会想到加数据包长度字段! 



**那么如何能够尽可能的提高应用层的包解析效率呢?**

应用层维护额外的读写缓冲区,  每次recv的时候尽可能大的读取更多的数据, 放到应用层缓冲区, 如果够包头大小就解析获取长度, 如果够长度, 就解析包体; 不够就继续读!











